<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFL PREDICTIONS</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #3d2c5c 0%, #503d72 50%, #3d2c5c 100%); min-height: 100vh; padding: 2rem; color: white; }
        .container { max-width: 1400px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 3rem; }
        h1 { font-size: 3rem; margin-bottom: 0.5rem; }
        .subtitle { color: #d4c5f9; font-size: 1.2rem; }
        .api-setup { background: rgba(107, 79, 158, 0.3); border: 2px solid #6b4f9e; border-radius: 1rem; padding: 1.5rem; margin-bottom: 2rem; }
        .api-setup input { width: 100%; padding: 0.75rem; border-radius: 0.5rem; border: none; background: rgba(255, 255, 255, 0.1); color: white; font-size: 1rem; }
        .api-setup button { margin-top: 0.5rem; padding: 0.75rem 2rem; border-radius: 0.5rem; border: none; background: #6b4f9e; color: white; font-weight: bold; cursor: pointer; }
        .scoreboard { background: linear-gradient(135deg, #6b4f9e 0%, #7c5caf 100%); border-radius: 1.5rem; padding: 2rem; margin-bottom: 3rem; box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
        .games-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 2rem; }
        .game-card { border-radius: 1.5rem; overflow: hidden; box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        .game-header { padding: 2rem; }
        .game-meta { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
        .badge { background: rgba(255,255,255,0.2); padding: 0.4rem 1rem; border-radius: 2rem; font-size: 0.85rem; font-weight: bold; }
        .confidence-high { background: #10b981; }
        .confidence-medium { background: #f59e0b; }
        .confidence-low { background: #ef4444; }
        .teams { display: flex; justify-content: space-between; align-items: center; }
        .team { display: flex; align-items: center; gap: 1rem; }
        .team-logo { width: 64px; height: 64px; }
        .team-name { font-size: 1.3rem; font-weight: bold; }
        .team-record { opacity: 0.8; font-size: 0.9rem; }
        .vs { font-size: 2rem; font-weight: bold; opacity: 0.8; }
        .game-body { padding: 2rem; background: rgba(31, 41, 55, 0.5); }
        .prediction-section { background: rgba(107, 79, 158, 0.3); border-radius: 1rem; padding: 1.5rem; margin-bottom: 1.5rem; }
        .prediction-title { color: #d4c5f9; font-size: 0.9rem; margin-bottom: 1rem; font-weight: 600; }
        .prediction-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .pred-stat { background: rgba(55, 65, 81, 0.5); padding: 1rem; border-radius: 0.75rem; text-align: center; }
        .pred-value { font-size: 1.8rem; font-weight: bold; }
        .stats-breakdown { display: grid; gap: 0.75rem; }
        .stat-row { display: flex; justify-content: space-between; background: rgba(55, 65, 81, 0.3); padding: 0.75rem; border-radius: 0.5rem; }
        .loading { text-align: center; padding: 4rem; font-size: 1.5rem; }
        .error { background: rgba(239, 68, 68, 0.2); border: 2px solid #ef4444; border-radius: 1rem; padding: 1.5rem; margin-bottom: 2rem; text-align: center; display: none; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèà NFL PREDICTIONS</h1>
            <p class="subtitle">Odds ‚Ä¢ Records ‚Ä¢ Injuries ‚Ä¢ Weather ‚Ä¢ Props ‚Ä¢ Expert Consensus</p>
        </header>

        <div class="api-setup" id="apiSetup">
            <h3>üîë The Odds API Key (Required)</h3>
            <p>Get free key: <a href="https://the-odds-api.com" target="_blank">the-odds-api.com</a></p>
            <input type="text" id="apiKeyInput" placeholder="Enter your API key here" />
            <button onclick="saveApiKey()">Save & Load</button>
        </div>

        <div id="error" class="error"></div>
        <div id="loading" class="loading">Enter API key to load...</div>
        <div id="games" class="games-grid"></div>
    </div>

    <script>
        const TEAM_DATA = { /* Full original TEAM_DATA */ };

        const DIMERS_DATA = {
            "Washington Commanders": { opp: "New York Giants", dimersWinPct: 43, favored: false },
            "Las Vegas Raiders": { opp: "Philadelphia Eagles", dimersWinPct: 12, favored: false },
            "Cleveland Browns": { opp: "Chicago Bears", dimersWinPct: 22, favored: false },
            "Baltimore Ravens": { opp: "Cincinnati Bengals", dimersWinPct: 56, favored: true },
            "Arizona Cardinals": { opp: "Houston Texans", dimersWinPct: 22, favored: false },
            "Buffalo Bills": { opp: "New England Patriots", dimersWinPct: 57, favored: true },
            "New York Jets": { opp: "Jacksonville Jaguars", dimersWinPct: 10, favored: false },
            "Los Angeles Chargers": { opp: "Kansas City Chiefs", dimersWinPct: 29, favored: false },
            "Indianapolis Colts": { opp: "Seattle Seahawks", dimersWinPct: 11, favored: false },
            "Tennessee Titans": { opp: "San Francisco 49ers", dimersWinPct: 13, favored: false },
            "Green Bay Packers": { opp: "Denver Broncos", dimersWinPct: 58, favored: true },
            "Carolina Panthers": { opp: "New Orleans Saints", dimersWinPct: 59, favored: true },
            "Detroit Lions": { opp: "Los Angeles Rams", dimersWinPct: 32, favored: false },
            "Minnesota Vikings": { opp: "Dallas Cowboys", dimersWinPct: 27, favored: false },
            "Miami Dolphins": { opp: "Pittsburgh Steelers", dimersWinPct: 40, favored: false }
            // Add reverses for home/away matching
        };

        let apiKey = localStorage.getItem('nfl_odds_api_key');
        let teamStats = {};

        function saveApiKey() {
            apiKey = document.getElementById('apiKeyInput').value.trim();
            if (apiKey) {
                localStorage.setItem('nfl_odds_api_key', apiKey);
                document.getElementById('apiSetup').style.display = 'none';
                loadAllData();
            }
        }

        async function loadAllData() {
            document.getElementById('loading').textContent = 'Loading...';
            await fetchTeamStats();
            await fetchGamesAndOdds();
        }

        async function fetchTeamStats() { /* Original */ }

        async function fetchGamesAndOdds() { /* Original fetch games + odds */ }

        function generatePrediction(game, oddsGame) {
            const home = /* home team */;
            const away = /* away team */;

            let pred = { /* base from odds, records */ };

            // Factor Dimers
            const dimers = DIMERS_DATA[home] || DIMERS_DATA[away];
            if (dimers) {
                const dimersFav = (dimers.dimersWinPct > 50) ? (dimers.favored ? home : away) : (dimers.favored ? away : home);
                const dimersWeight = dimers.dimersWinPct / 100;
                // Blend with model: adjust score margin toward Dimers favored team
                const blend = 0.4; // 40% Dimers influence
                if (dimersFav === home) pred.homeScore += blend * 7 * dimersWeight;
                else pred.awayScore += blend * 7 * (1 - dimersWeight);
            }

            // Weather placeholder adjustments (cold favors run)
            pred.homeRBYards += 20; pred.awayRBYards += 20; // example cold week

            // Sharp pick: winner, spread beat, top props (hardcoded examples)
            pred.sharpPick = pred.homeScore > pred.awayScore ? home : away;
            pred.beatsSpread = /* calc */;
            pred.topProps = ["Josh Jacobs Over rushing yds", "Cowboys team total Over", "Seahawks -13.5"]; // from sources

            // Player stats
            pred.homeQBYards = Math.round(pred.homeScore * 11);
            pred.homeQBTDs = Math.max(1, Math.floor(pred.homeScore / 9));
            pred.awayQBYards = Math.round(pred.awayScore * 11);
            pred.awayQBTDs = Math.max(1, Math.floor(pred.awayScore / 9));
            pred.homeRBYards = Math.round(pred.homeScore * 5);
            pred.awayRBYards = Math.round(pred.awayScore * 5);

            pred.confidence = /* based on margin + Dimers alignment */;

            return pred;
        }

        function createGameCard(game, pred) {
            return `
            <div class="game-card">
                <div class="game-header" style="background-color: ${color}ee;">
                    <!-- teams, time, confidence badge -->
                </div>
                <div class="game-body">
                    <div class="prediction-section"><div class="prediction-title">Sharp Pick</div><strong>${pred.sharpPick} (${pred.confidence})</strong></div>
                    <div class="prediction-section"><div class="prediction-title">Score Prediction</div><!-- grid --></div>
                    <div class="prediction-section"><div class="prediction-title">Weather / Surface</div><!-- details --></div>
                    <div class="prediction-section"><div class="prediction-title">Key Injuries</div><!-- list --></div>
                    <div class="prediction-section"><div class="prediction-title">Betting Lines</div><!-- spread, total, ML, beats spread --></div>
                    <div class="prediction-section"><div class="prediction-title">Best Prop Bets</div><div class="stats-breakdown">${pred.topProps.map(p => `<div class="stat-row"><strong>${p}</strong></div>`).join('')}</div></div>
                    <div class="prediction-section"><div class="prediction-title">Player Projections</div><!-- QB/RB yds/TDs --></div>
                    <div class="prediction-section"><div class="prediction-title">Consensus Insight (incl. Dimers)</div>Dimers: ${pred.dimersWinPct}% for favorite</div>
                </div>
            </div>`;
        }

        // displayGames, scheduling same

        if (apiKey) { document.getElementById('apiSetup').style.display = 'none'; loadAllData(); }
    </script>
</body>
</html>
